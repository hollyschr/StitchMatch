import React, { useState, useEffect } from 'react';
import { Button } from '@/components/ui/button';
import { Scissors, LogOut, User, Heart } from 'lucide-react';
import { useNavigate, useLocation } from 'react-router-dom';

interface User {
  user_id: number;
  name: string;
  email: string;
  profile_photo?: string;
}

const Header = () => {
  const navigate = useNavigate();
  const location = useLocation();
  const [currentUser, setCurrentUser] = useState<User | null>(null);

  useEffect(() => {
    const savedUser = localStorage.getItem('currentUser');
    if (savedUser) {
      setCurrentUser(JSON.parse(savedUser));
    }
  }, []);

  const handleLogout = () => {
    localStorage.removeItem('currentUser');
    setCurrentUser(null);
    navigate('/');
  };

  return (
    <header className="bg-white shadow-sm border-b">
      <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div className="flex justify-between items-center py-4">
          <div className="flex items-center space-x-2 cursor-pointer" onClick={() => navigate('/')}>
            {/* <Scissors className="h-8 w-8 text-green-600" /> */}
            <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 512 512" className="h-8 w-8" style={{ fill: '#16A34A' }}>
              <path d="M0 0 C4.82799492 2.31947346 8.59633752 4.94399083 12.09375 9.05859375 C12.83625 9.90421875 13.57875 10.74984375 14.34375 11.62109375 C16.06213861 14.0145636 16.75568411 15.18503366 17.09375 18.05859375 C17.2175 19.08984375 17.34125 20.12109375 17.46875 21.18359375 C16.51652037 31.0232999 10.05521393 38.47462547 3.09375 45.05859375 C-1.72326129 48.98846564 -6.68876929 51.95722509 -12.3046875 54.58984375 C-18.71376835 58.07750116 -21.35179298 62.46300765 -24.65625 68.80859375 C-25.84979219 70.97291453 -27.04381923 73.13696798 -28.23828125 75.30078125 C-28.8410791 76.41678711 -29.44387695 77.53279297 -30.06494141 78.68261719 C-33.0526666 84.16050952 -36.20657757 89.54040364 -39.34375 94.93359375 C-40.60393563 97.11787201 -41.86304539 99.30277132 -43.12109375 101.48828125 C-46.25745819 106.9330552 -49.39624383 112.37642481 -52.53710938 117.81860352 C-53.77500951 119.96439409 -55.01200118 122.11070903 -56.24804688 124.25756836 C-59.18437494 129.35544627 -62.12933229 134.44777922 -65.10372925 139.52352905 C-66.51431667 141.93183251 -67.92018561 144.34287405 -69.32568359 146.75415039 C-70.32449587 148.46314932 -71.3301523 150.16814235 -72.3359375 151.87304688 C-73.23505859 153.41702148 -73.23505859 153.41702148 -74.15234375 154.9921875 C-74.68529053 155.90025146 -75.2182373 156.80831543 -75.76733398 157.74389648 C-77.12699415 160.07727399 -77.12699415 160.07727399 -76.90625 163.05859375 C-74.50453216 164.89679686 -72.12843185 166.54834258 -69.59375 168.18359375 C-61.56301485 173.53476239 -53.9223692 179.15432648 -46.96484375 185.875 C-46.47411377 186.34284912 -45.98338379 186.81069824 -45.4777832 187.29272461 C-44.10896004 188.60887407 -42.76082128 189.94643782 -41.4140625 191.28515625 C-39.09390625 193.33486552 -39.09390625 193.33486552 -36.55102539 192.83398438 C-33.74255243 192.01060118 -31.59308297 190.9248053 -29.08203125 189.42578125 C-28.14955566 188.8747876 -27.21708008 188.32379395 -26.25634766 187.75610352 C-25.25394043 187.15467529 -24.2515332 186.55324707 -23.21875 185.93359375 C-21.04599019 184.64773216 -18.87279843 183.36260023 -16.69921875 182.078125 C-15.57692871 181.41248535 -14.45463867 180.7468457 -13.29833984 180.06103516 C-7.89930895 176.87384274 -2.4657386 173.74731683 2.96875 170.62109375 C5.13807487 169.37118754 7.30734531 168.12118684 9.4765625 166.87109375 C10.55969727 166.2471875 11.64283203 165.62328125 12.75878906 164.98046875 C15.60172323 163.34213949 18.44399478 161.7026723 21.28552246 160.06190491 C23.01064121 159.06598114 24.73627579 158.07095105 26.46191406 157.07592773 C28.69329022 155.78610468 30.92187715 154.49144263 33.14746094 153.19165039 C37.56192854 150.62062044 41.94401484 148.07168548 46.5546875 145.8671875 C55.10749172 141.71087838 58.4241366 137.13069043 62.31640625 128.75 C67.0400326 118.58263475 75.512205 110.59510712 85.65625 105.86328125 C90.95253008 104.11482981 96.15647224 104.33982024 101.28125 106.55859375 C108.294903 110.53253233 112.91285075 118.44995088 115.09375 126.05859375 C115.89895298 131.88399085 115.96438487 137.52109245 112.53125 142.50390625 C103.3281986 152.4572064 89.88004698 154.40288246 77.015625 154.98046875 C73.09375 155.05859375 73.09375 155.05859375 71.02929688 154.84814453 C63.51824133 154.25151928 58.38438615 157.66904645 52.09375 161.43359375 C50.98507568 162.07627197 49.87640137 162.7189502 48.73413086 163.38110352 C45.5095803 165.25543936 42.30038701 167.15382109 39.09375 169.05859375 C37.59587435 169.93630061 36.09729015 170.81280065 34.59765625 171.6875 C31.93943004 173.24156489 29.28826407 174.80688043 26.640625 176.37890625 C20.92585749 179.76148702 15.16281371 183.0603478 9.40625 186.37109375 C-2.4187156 193.17628038 -14.17891534 200.08669151 -25.90625 207.05859375 C-23.59063701 211.40036812 -21.02852292 215.29854782 -18.0703125 219.234375 C-13.85514962 224.95578992 -10.50432513 230.92309645 -7.28125 237.24609375 C-6.71784912 238.34687256 -6.15444824 239.44765137 -5.57397461 240.58178711 C17.93316607 287.16891444 19.01137429 339.52363568 2.93310547 388.53027344 C2.51762451 389.78179199 2.51762451 389.78179199 2.09375 391.05859375 C1.80258301 391.93676758 1.51141602 392.81494141 1.21142578 393.71972656 C0.50830513 395.83362477 -0.19740662 397.94660895 -0.90625 400.05859375 C-0.35388672 400.25380615 0.19847656 400.44901855 0.76757812 400.65014648 C22.70515415 408.48596874 46.73052736 418.35261133 57.36328125 440.73046875 C61.43860341 450.46516056 62.49941645 459.45482385 59.12890625 469.58203125 C53.53624048 482.96222031 41.82907445 492.49389344 28.69140625 497.9453125 C13.29907228 504.00381314 -2.32960829 507.16790329 -18.8828125 507.26171875 C-20.13634773 507.27210426 -20.13634773 507.27210426 -21.41520691 507.28269958 C-24.12060268 507.29996086 -26.82580162 507.30629612 -29.53125 507.30859375 C-30.46021088 507.30993317 -31.38917175 507.31127258 -32.34628296 507.31265259 C-54.1761048 507.30585924 -75.69277788 505.60706041 -97.22973633 501.88549805 C-106.50339962 500.37427096 -114.32251513 502.30080637 -123.21875 504.93359375 C-159.25363479 514.96126545 -198.43189424 514.12058633 -233.90625 502.05859375 C-234.86241211 501.74631836 -234.86241211 501.74631836 -235.83789062 501.42773438 C-249.82071036 496.82346242 -263.65691405 490.2473005 -275.671875 481.72265625 C-279.20752193 479.3265275 -281.35366176 478.33530193 -285.71875 478.93359375 C-286.82863281 479.083125 -287.93851562 479.23265625 -289.08203125 479.38671875 C-290.34402344 479.6084375 -291.60601562 479.83015625 -292.90625 480.05859375 C-293.63247559 480.17525391 -294.35870117 480.29191406 -295.10693359 480.41210938 C-317.63038528 484.07445924 -339.4523839 491.31917591 -358.15625 504.68359375 C-361.01862818 506.68668941 -362.07883261 507.08688598 -365.71875 507.68359375 C-368.90625 507.05859375 -368.90625 507.05859375 -371.34375 505.49609375 C-373.53646887 502.07545232 -373.53632693 500.04908096 -372.90625 496.05859375 C-352.29646839 472.48310586 -311.30653163 464.06150391 -281.84375 461.68359375 C-251.78729614 459.68040703 -221.65487272 462.63906624 -192.07421875 467.94921875 C-191.16366226 468.11235565 -190.25310577 468.27549255 -189.31495667 468.443573 C-184.84675397 469.24998511 -180.38479677 470.08062189 -175.92797852 470.94775391 C-174.30095788 471.2530036 -172.67392402 471.55818288 -171.046875 471.86328125 C-169.94287605 472.08942108 -169.94287605 472.08942108 -168.8165741 472.32012939 C-160.07439381 473.93116552 -153.38542237 469.49170925 -145.78125 465.68359375 C-144.72389648 465.15411133 -143.66654297 464.62462891 -142.57714844 464.07910156 C-128.08645831 456.72295812 -114.29913689 448.24884345 -100.90625 439.05859375 C-114.08524102 430.79781728 -114.08524102 430.79781728 -128.7734375 428.65234375 C-131.70612042 430.43681914 -134.25159643 432.33730881 -136.88330078 434.52441406 C-141.04367306 437.67958898 -145.7460524 439.98485957 -150.34375 442.43359375 C-151.36194824 442.9855542 -152.38014648 443.53751465 -153.42919922 444.10620117 C-160.66931469 447.99126548 -168.0144957 451.55382932 -175.53125 454.87109375 C-176.48443115 455.2976123 -177.4376123 455.72413086 -178.41967773 456.16357422 C-186.82640191 459.77196748 -186.82640191 459.77196748 -191.90625 459.05859375 C-194.78125 457.55859375 -194.78125 457.55859375 -196.90625 455.05859375 C-197.6213593 452.24429262 -197.82525299 449.82641452 -196.90625 447.05859375 C-192.87121722 442.96718326 -187.78715363 441.03785635 -182.59375 438.80859375 C-169.26130755 432.94163884 -156.37100153 426.61298862 -143.90625 419.05859375 C-145.88382724 417.82681071 -147.86325175 416.59816552 -149.84375 415.37109375 C-150.94589844 414.68660156 -152.04804688 414.00210937 -153.18359375 413.296875 C-153.77954346 412.94842529 -154.37549316 412.59997559 -154.98950195 412.2409668 C-156.90625 411.05859375 -156.90625 411.05859375 -158.95385742 409.49536133 C-161.29527198 407.85912574 -163.13898191 406.79205013 -165.90625 406.05859375 C-170.13042839 406.9676535 -173.60524562 409.0054233 -177.34375 411.12109375 C-179.56603119 412.28037964 -181.79274585 413.43119983 -184.0234375 414.57421875 C-185.16135742 415.16267578 -186.29927734 415.75113281 -187.47167969 416.35742188 C-219.90254853 432.42070692 -261.59585773 444.05859375 -297.90625 444.05859375 C-297.803125 444.96609375 -297.7 445.87359375 -297.59375 446.80859375 C-297.90625 450.05859375 -297.90625 450.05859375 -299.96875 452.49609375 C-302.90625 454.05859375 -302.90625 454.05859375 -306.28125 454.24609375 C-321.26291593 449.33830663 -333.26231348 424.26102106 -340.14453125 411.00244141 C-358.18330381 375.22960528 -366.01068724 333.79985679 -358.90625 294.05859375 C-358.68026123 292.77686279 -358.68026123 292.77686279 -358.44970703 291.46923828 C-351.73526465 254.72362995 -335.09677896 222.52101383 -309.90625 195.05859375 C-309.43783691 194.54490234 -308.96942383 194.03121094 -308.48681641 193.50195312 C-282.44295064 165.29455454 -246.76970887 147.85287649 -209.59375 140.12109375 C-208.52527832 139.89695801 -207.45680664 139.67282227 -206.35595703 139.44189453 C-195.10654402 137.24509381 -195.10654402 137.24509381 -190.03125 140.12109375 C-188.17889722 143.31125687 -188.30866789 146.53001368 -188.90625 150.05859375 C-190.21875 152.49609375 -190.21875 152.49609375 -192.90625 154.05859375 C-194.78791853 154.32041955 -196.67980724 154.51330173 -198.57421875 154.65625 C-199.57090576 154.73496338 -200.56759277 154.81367676 -201.59448242 154.89477539 C-202.35736572 154.94883545 -203.12024902 155.00289551 -203.90625 155.05859375 C-202.47479586 158.45700684 -201.03502496 161.85183536 -199.59375 165.24609375 C-199.18962891 166.20580078 -198.78550781 167.16550781 -198.36914062 168.15429688 C-197.97275391 169.08564453 -197.57636719 170.01699219 -197.16796875 170.9765625 C-196.80662842 171.83016357 -196.44528809 172.68376465 -196.07299805 173.56323242 C-194.84838774 176.1823456 -193.43340468 178.60554152 -191.90625 181.05859375 C-191.21515137 180.79755859 -190.52405273 180.53652344 -189.81201172 180.26757812 C-168.54886063 172.29956548 -147.12988233 165.83273603 -124.90625 161.05859375 C-134.38688197 157.50335676 -144.31267866 155.66180767 -154.35546875 154.53125 C-155.07597412 154.45011963 -155.79647949 154.36898926 -156.53881836 154.28540039 C-158.55038387 154.0699335 -160.56423789 153.87615666 -162.578125 153.68359375 C-165.94880173 153.05060282 -167.51342568 152.46888394 -169.90625 150.05859375 C-171.08032634 146.45809297 -171.23384676 144.77930662 -169.65625 141.30859375 C-167.90625 139.05859375 -167.90625 139.05859375 -164.90625 137.05859375 C-140.47146572 135.78117205 -115.169375 144.98951909 -92.90625 154.05859375 C-92.06707031 152.5271875 -92.06707031 152.5271875 -91.2109375 150.96484375 C-85.78447603 141.10758063 -80.19317428 131.35782436 -74.50341797 121.65039062 C-69.91736478 113.8166505 -65.39930477 105.9458348 -60.90625 98.05859375 C-55.73957189 88.99252414 -50.53988104 79.94677427 -45.28125 70.93359375 C-44.72566406 69.98097656 -44.17007812 69.02835937 -43.59765625 68.046875 C-43.06785156 67.14066406 -42.53804688 66.23445313 -41.9921875 65.30078125 C-41.23156006 63.9861792 -41.23156006 63.9861792 -40.45556641 62.64501953 C-39.41085238 60.90097597 -38.31753104 59.18526342 -37.18115234 57.49951172 C-33.22555142 51.51682477 -32.20683567 47.53125842 -32.78125 40.43359375 C-33.26242211 28.18150484 -31.64722089 15.10632961 -23.90625 5.05859375 C-17.20768903 -1.77228447 -9.14446468 -2.96211826 0 0 Z" />
            </svg>
            <h1 className="text-2xl font-bold text-gray-900">StitchMatch</h1>
          </div>
          <nav className="flex items-center space-x-4">
            {currentUser ? (
              <>
                <Button
                  variant={location.pathname === '/stash' ? 'outline' : 'ghost'}
                  onClick={() => navigate('/stash')}
                >
                  My Stash
                </Button>
                <Button
                  variant={location.pathname === '/patterns' ? 'outline' : 'ghost'}
                  onClick={() => navigate('/patterns')}
                >
                  Patterns
                </Button>
                <Button
                  variant={location.pathname === '/search' ? 'outline' : 'ghost'}
                  onClick={() => navigate('/search')}
                >
                  Search
                </Button>
                <Button
                  variant={location.pathname === '/favorites' ? 'outline' : 'ghost'}
                  onClick={() => navigate('/favorites')}
                >
                  <Heart className="h-4 w-4 mr-1" />
                  Favorites
                </Button>
                <div className="flex items-center space-x-6">
                  <span className="text-sm text-gray-600">Welcome, {currentUser.name}</span>
                  <Button variant="outline" size="sm" onClick={handleLogout}>
                    <LogOut className="h-4 w-4 mr-1" />
                    Logout
                  </Button>
                </div>
              </>
            ) : (
              <>
                <Button
                  variant={location.pathname === '/search' ? 'outline' : 'ghost'}
                  onClick={() => navigate('/search')}
                >
                  Search
                </Button>
                <Button onClick={() => navigate('/login')}>
                  <User className="h-4 w-4 mr-2" />
                  Login
                </Button>
              </>
            )}
          </nav>
        </div>
      </div>
    </header>
  );
};

export default Header;